using FluentAssertions;
using MediaBrowser.Plugins.AniMetadata.Configuration;
using MediaBrowser.Plugins.AniMetadata.Files;
using NUnit.Framework;

namespace MediaBrowser.Plugins.AniMetadata.Tests
{
    [TestFixture]
    public class PluginConfigurationTests
    {
        [Test]
        public void CanBeDeserialised()
        {
            var expected = new PluginConfiguration();

            var actual = new XmlSerialiser().Deserialise<PluginConfiguration>(
                @"<?xml version=""1.0"" encoding=""utf-16""?>
<PluginConfiguration xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"">
  <TitlePreference>Localized</TitlePreference>
  <MaxGenres>5</MaxGenres>
  <MoveExcessGenresToTags>true</MoveExcessGenresToTags>
  <AddAnimeGenre>true</AddAnimeGenre>
  <SeriesMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Name</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Name</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>Name</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Name</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>PremiereDate</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>PremiereDate</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>PremiereDate</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>PremiereDate</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>EndDate</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>EndDate</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>EndDate</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>CommunityRating</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>CommunityRating</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>CommunityRating</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>CommunityRating</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Overview</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Overview</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>Overview</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Overview</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Studios</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Studios</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Studios</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Genres</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Genres</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>Genres</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Genres</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Tags</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Tags</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>Tags</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Tags</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>People</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>People</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>People</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>AirDays</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>AirDays</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>AirDays</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>AirTime</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>AirTime</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>AirTime</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
  </SeriesMappings>
</PluginConfiguration>");

            actual.ShouldBeEquivalentTo(expected);
        }

        [Test]
        public void CanBeSerialised()
        {
            var configuration = new PluginConfiguration();

            var serialised = new XmlSerialiser().Serialise(configuration);

            serialised.Should()
                .Be(@"<?xml version=""1.0"" encoding=""utf-16""?>
<PluginConfiguration xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"">
  <TitlePreference>Localized</TitlePreference>
  <MaxGenres>5</MaxGenres>
  <MoveExcessGenresToTags>true</MoveExcessGenresToTags>
  <AddAnimeGenre>true</AddAnimeGenre>
  <SeriesMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Name</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Name</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>Name</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Name</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>PremiereDate</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>PremiereDate</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>PremiereDate</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>PremiereDate</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>EndDate</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>EndDate</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>EndDate</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>CommunityRating</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>CommunityRating</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>CommunityRating</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>CommunityRating</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Overview</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Overview</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>Overview</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Overview</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Studios</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Studios</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Studios</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Genres</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Genres</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>Genres</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Genres</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>Tags</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>Tags</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>Tags</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>Tags</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>People</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>AniDB</SourceName>
          <TargetPropertyName>People</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>People</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>AirDays</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>AirDays</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>AirDays</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
    <TargetPropertyMappings>
      <TargetPropertyName>AirTime</TargetPropertyName>
      <Mappings>
        <MappingKey>
          <SourceName>TvDB</SourceName>
          <TargetPropertyName>AirTime</TargetPropertyName>
        </MappingKey>
        <MappingKey>
          <SourceName>None</SourceName>
          <TargetPropertyName>AirTime</TargetPropertyName>
        </MappingKey>
      </Mappings>
    </TargetPropertyMappings>
  </SeriesMappings>
</PluginConfiguration>");
        }
    }
}